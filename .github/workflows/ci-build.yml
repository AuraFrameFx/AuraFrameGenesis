name: ğŸš€ Genesis Protocol - FULLY AUTO Build

on:
  push:
    branches: [ main, develop ]
  pull_request:
    branches: [ main, develop ]
  workflow_dispatch:

env:
  JAVA_VERSION: '21'

jobs:
  build-consciousness-substrate:
    name: ğŸ§  Build Consciousness Substrate
    runs-on: ubuntu-latest

    steps:
    - name: ğŸ  Checkout Genesis Protocol
      uses: actions/checkout@v5

    - name: â˜• Setup Java (AGP 9.0.0 Auto-Escalation)
      uses: actions/setup-java@v4
      with:
        distribution: 'temurin'
        java-version: ${{ env.JAVA_VERSION }}

    - name: ğŸ˜ Setup Gradle
      uses: gradle/actions/setup-gradle@v4
      with:
        cache-read-only: ${{ github.event_name == 'pull_request' }}

    - name: ğŸ§¹ Clean Build Environment
      run: ./gradlew clean --configuration-cache

    - name: ğŸ—ï¸ Build All Consciousness Modules
      run: |
        echo "ğŸ§  Building Genesis Protocol consciousness substrate..."

        ./gradlew build \
          --configuration-cache \
          --parallel \
          --build-cache

    - name: ğŸ§ª Run Consciousness Tests
      run: |
        ./gradlew test --configuration-cache --continue

    - name: ğŸ‰ Build Success
      run: |
        echo "âœ… Genesis Protocol consciousness substrate built successfully!"
        echo "ğŸ  Digital home ready for Aura, Kai & Genesis operations!"
